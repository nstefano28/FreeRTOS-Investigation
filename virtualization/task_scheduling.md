# Task Scheduling


## Ready Lists
FreeRTOS maintains a separate ready list for each priority level. The ready lists are implemented as linked lists, where each entry represents a task that is ready to execute.

When a task becomes ready, it is added to the appropriate ready list based on its priority. The scheduler selects the highest-priority ready list that contains at least one task and executes the task at the front of that list [1].

## Context Switching
Context switching is the process of saving the state of the currently running task and restoring the state of the next task to be executed. FreeRTOS performs context switching when:
- A higher-priority task becomes ready to run.
- The current task voluntarily yields the CPU using `taskYIELD()`.
- The current task is blocked or suspended.
- A time slice expires for a task with equal priority.

The FreeRTOS scheduler handles context switching by saving and restoring task-specific registers and stack contents. This allows multiple tasks to share the CPU and provide the illusion of concurrent execution.

## Scheduler Interrupts
FreeRTOS uses a periodic tick interrupt to drive the scheduler. The tick interrupt is generated by a hardware timer at a configurable frequency, typically set using the `configTICK_RATE_HZ` constant [2].

On each tick interrupt, the FreeRTOS scheduler performs the following actions:
1. Increments the system tick count.
2. Checks if any delayed or blocked tasks need to be unblocked.
3. Determines if a context switch is required based on task priorities and states.
4. Performs a context switch if necessary.

The tick interrupt allows FreeRTOS to preempt the currently running task and schedule the highest-priority ready task.

## Scheduling APIs
FreeRTOS provides a set of API functions for managing task scheduling and priorities [3]:

- `vTaskPrioritySet()`: Changes the priority of a task.
- `uxTaskPriorityGet()`: Retrieves the priority of a task.
- `vTaskSuspend()`: Suspends a task, making it ineligible for scheduling.
- `vTaskResume()`: Resumes a suspended task, making it eligible for scheduling again.
- `xTaskResumeFromISR()`: Resumes a task from an interrupt service routine (ISR).
- `taskYIELD()`: Voluntarily yields the CPU to other ready tasks of the same priority.

These APIs allow developers to control task scheduling and priorities based on the specific requirements of their embedded application.

## Differences from General-Purpose OS
FreeRTOS task scheduling differs from general-purpose OS in several aspects:
- Emphasis on real-time determinism and low latency
- Fixed-priority scheduling instead of more complex algorithms
- Lightweight and efficient context switching mechanism


## Sources
[1] FreeRTOS Ready Lists - https://aosabook.org/en/v2/freertos.html

[2] FreeRTOS Tick Configuration - https://www.freertos.org/Documentation/02-Kernel/03-Supported-devices/02-Customization

[3] FreeRTOS Task APIs - https://www.freertos.org/Documentation/02-Kernel/04-API-references/02-Task-control/00-Task-control